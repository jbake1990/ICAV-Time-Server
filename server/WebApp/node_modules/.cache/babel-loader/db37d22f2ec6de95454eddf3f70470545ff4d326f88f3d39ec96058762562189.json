{"ast":null,"code":"import _objectSpread from\"/Users/jasonbaker/Documents/ICAV Time Tracker/WebApp/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";// Use relative URLs in production (Vercel) and allow override in development\nconst API_BASE_URL=process.env.REACT_APP_API_URL||(process.env.NODE_ENV==='production'?'':'http://localhost:3000');// Authentication helper functions\nconst getAuthToken=()=>{return localStorage.getItem('authToken');};export const setAuthToken=token=>{localStorage.setItem('authToken',token);};export const removeAuthToken=()=>{localStorage.removeItem('authToken');};const getAuthHeaders=()=>{const token=getAuthToken();return token?{'Authorization':\"Bearer \".concat(token)}:{};};export const api={// Authentication\nasync login(username,password){const url=\"\".concat(API_BASE_URL,\"/api/auth\");const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'login',username,password})});if(!response.ok){const errorData=await response.json().catch(()=>({error:'Login failed'}));throw new Error(errorData.error||'Login failed');}return response.json();},async logout(){const token=getAuthToken();if(token){const url=\"\".concat(API_BASE_URL,\"/api/auth\");await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'logout',sessionToken:token})});}removeAuthToken();},async verifySession(){const token=getAuthToken();if(!token){throw new Error('No session token');}const url=\"\".concat(API_BASE_URL,\"/api/auth\");const response=await fetch(url,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({action:'verify',sessionToken:token})});if(!response.ok){throw new Error('Session verification failed');}return response.json();},// Time Entries\nasync getTimeEntries(){const url=\"\".concat(API_BASE_URL,\"/api/time-entries\");console.log('Fetching time entries from:',url);// Debug log\nconst response=await fetch(url,{headers:_objectSpread({},getAuthHeaders())});if(!response.ok){console.error('API response not ok:',response.status,response.statusText);throw new Error(\"Failed to fetch time entries: \".concat(response.status,\" \").concat(response.statusText));}return response.json();},async createTimeEntry(data){const url=\"\".concat(API_BASE_URL,\"/api/time-entries\");const response=await fetch(url,{method:'POST',headers:_objectSpread({'Content-Type':'application/json'},getAuthHeaders()),body:JSON.stringify(data)});if(!response.ok){throw new Error(\"Failed to create time entry: \".concat(response.status,\" \").concat(response.statusText));}return response.json();},// Users\nasync getUsers(){const url=\"\".concat(API_BASE_URL,\"/api/users\");const response=await fetch(url,{headers:_objectSpread({},getAuthHeaders())});if(!response.ok){throw new Error(\"Failed to fetch users: \".concat(response.status,\" \").concat(response.statusText));}return response.json();},async createUser(data){const url=\"\".concat(API_BASE_URL,\"/api/users\");const response=await fetch(url,{method:'POST',headers:_objectSpread({'Content-Type':'application/json'},getAuthHeaders()),body:JSON.stringify(data)});if(!response.ok){throw new Error(\"Failed to create user: \".concat(response.status,\" \").concat(response.statusText));}return response.json();},async deleteUser(userId){const url=\"\".concat(API_BASE_URL,\"/api/users?userId=\").concat(encodeURIComponent(userId));const response=await fetch(url,{method:'DELETE',headers:_objectSpread({},getAuthHeaders())});if(!response.ok){const errorData=await response.json().catch(()=>({error:'Unknown error'}));throw new Error(errorData.error||\"Failed to delete user: \".concat(response.status,\" \").concat(response.statusText));}return response.json();}};","map":{"version":3,"names":["API_BASE_URL","process","env","REACT_APP_API_URL","NODE_ENV","getAuthToken","localStorage","getItem","setAuthToken","token","setItem","removeAuthToken","removeItem","getAuthHeaders","concat","api","login","username","password","url","response","fetch","method","headers","body","JSON","stringify","action","ok","errorData","json","catch","error","Error","logout","sessionToken","verifySession","getTimeEntries","console","log","_objectSpread","status","statusText","createTimeEntry","data","getUsers","createUser","deleteUser","userId","encodeURIComponent"],"sources":["/Users/jasonbaker/Documents/ICAV Time Tracker/WebApp/src/services/api.ts"],"sourcesContent":["// Use relative URLs in production (Vercel) and allow override in development\nconst API_BASE_URL = process.env.REACT_APP_API_URL || (process.env.NODE_ENV === 'production' ? '' : 'http://localhost:3000');\n\n// Authentication helper functions\nconst getAuthToken = (): string | null => {\n  return localStorage.getItem('authToken');\n};\n\nexport const setAuthToken = (token: string): void => {\n  localStorage.setItem('authToken', token);\n};\n\nexport const removeAuthToken = (): void => {\n  localStorage.removeItem('authToken');\n};\n\nconst getAuthHeaders = (): Record<string, string> => {\n  const token = getAuthToken();\n  return token ? { 'Authorization': `Bearer ${token}` } : {};\n};\n\nexport interface ApiTimeEntry {\n  id: string;\n  userId: string;\n  technicianName: string;\n  customerName: string;\n  clockInTime: string;\n  clockOutTime?: string;\n  lunchStartTime?: string;\n  lunchEndTime?: string;\n  isActive: boolean;\n  isOnLunch: boolean;\n  duration?: number;\n  formattedDuration?: string;\n  lunchDuration?: number;\n  formattedLunchDuration?: string;\n}\n\nexport interface ApiUser {\n  id: string;\n  username: string;\n  displayName: string;\n  createdAt: string;\n  updatedAt: string;\n}\n\nexport const api = {\n  // Authentication\n  async login(username: string, password: string): Promise<{ user: any; token: string; expiresAt: string }> {\n    const url = `${API_BASE_URL}/api/auth`;\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ action: 'login', username, password }),\n    });\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({ error: 'Login failed' }));\n      throw new Error(errorData.error || 'Login failed');\n    }\n    return response.json();\n  },\n\n  async logout(): Promise<void> {\n    const token = getAuthToken();\n    if (token) {\n      const url = `${API_BASE_URL}/api/auth`;\n      await fetch(url, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ action: 'logout', sessionToken: token }),\n      });\n    }\n    removeAuthToken();\n  },\n\n  async verifySession(): Promise<{ user: any; token: string; expiresAt: string }> {\n    const token = getAuthToken();\n    if (!token) {\n      throw new Error('No session token');\n    }\n    \n    const url = `${API_BASE_URL}/api/auth`;\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ action: 'verify', sessionToken: token }),\n    });\n    \n    if (!response.ok) {\n      throw new Error('Session verification failed');\n    }\n    return response.json();\n  },\n\n  // Time Entries\n  async getTimeEntries(): Promise<ApiTimeEntry[]> {\n    const url = `${API_BASE_URL}/api/time-entries`;\n    console.log('Fetching time entries from:', url); // Debug log\n    \n    const response = await fetch(url, {\n      headers: {\n        ...getAuthHeaders(),\n      },\n    });\n    if (!response.ok) {\n      console.error('API response not ok:', response.status, response.statusText);\n      throw new Error(`Failed to fetch time entries: ${response.status} ${response.statusText}`);\n    }\n    return response.json();\n  },\n\n  async createTimeEntry(data: {\n    userId: string;\n    technicianName: string;\n    customerName: string;\n    clockInTime: string;\n    clockOutTime?: string;\n    lunchStartTime?: string;\n    lunchEndTime?: string;\n  }): Promise<ApiTimeEntry> {\n    const url = `${API_BASE_URL}/api/time-entries`;\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to create time entry: ${response.status} ${response.statusText}`);\n    }\n    return response.json();\n  },\n\n  // Users\n  async getUsers(): Promise<ApiUser[]> {\n    const url = `${API_BASE_URL}/api/users`;\n    const response = await fetch(url, {\n      headers: {\n        ...getAuthHeaders(),\n      },\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to fetch users: ${response.status} ${response.statusText}`);\n    }\n    return response.json();\n  },\n\n  async createUser(data: { username: string; displayName: string; password?: string; role?: string }): Promise<ApiUser> {\n    const url = `${API_BASE_URL}/api/users`;\n    const response = await fetch(url, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n        ...getAuthHeaders(),\n      },\n      body: JSON.stringify(data),\n    });\n    if (!response.ok) {\n      throw new Error(`Failed to create user: ${response.status} ${response.statusText}`);\n    }\n    return response.json();\n  },\n\n  async deleteUser(userId: string): Promise<{ message: string; deletedUser: { id: string; username: string; displayName: string } }> {\n    const url = `${API_BASE_URL}/api/users?userId=${encodeURIComponent(userId)}`;\n    const response = await fetch(url, {\n      method: 'DELETE',\n      headers: {\n        ...getAuthHeaders(),\n      },\n    });\n    if (!response.ok) {\n      const errorData = await response.json().catch(() => ({ error: 'Unknown error' }));\n      throw new Error(errorData.error || `Failed to delete user: ${response.status} ${response.statusText}`);\n    }\n    return response.json();\n  },\n}; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}